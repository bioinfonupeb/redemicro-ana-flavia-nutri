{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# The QIIME2 Pipeline Artifacts Analysis\n",
    "\n",
    "We will make analytical processing of the artifacts generated through the QIIME2's metagenomic pipeline."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Environment setup and data preparation\n",
    "\n",
    "Before starting the data analysis, we need to prepare and configure some computational resources.\n",
    "\n",
    "Initially, we configure the environment by importing some programming libraries and functions of specific packages. After that, we will define some paths for working folders and files. Some custom functions are implemented here for modularization purposes.\n",
    "\n",
    "In the next stage, we ingest some data artifacts and do transformations to load specific data formats and information to be used in the data analysis further."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setting the environment"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Importing packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.293843Z",
     "start_time": "2022-06-02T14:33:58.985801Z"
    }
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "import os\n",
    "from pathlib import Path\n",
    "import re\n",
    "from qiime2.plugins import feature_table\n",
    "from qiime2 import Artifact, Visualization\n",
    "from qiime2 import Metadata\n",
    "from qiime2.plugins.metadata.visualizers import tabulate\n",
    "from qiime2.plugins.feature_table.methods import filter_samples\n",
    "from qiime2.plugins.feature_table.methods import group\n",
    "from qiime2.plugins.feature_table.methods import presence_absence\n",
    "from qiime2.plugins.taxa.methods import collapse\n",
    "from qiime2.plugins import metadata\n",
    "from qiime2.plugins.feature_table.methods import filter_samples\n",
    "\n",
    "#from qiime2.plugins import demux, dada2, deblur, quality_filter, metadata, feature_table, alignment, phylogeny, diversity, emperor, feature_classifier, taxa, composition\n",
    "\n",
    "from IPython.display import display\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Defining the parameters\n",
    "The following cell can receive parameters using the [papermill](https://papermill.readthedocs.io/en/latest/) tool."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.299459Z",
     "start_time": "2022-06-02T14:34:05.296199Z"
    },
    "tags": [
     "parameters"
    ]
   },
   "outputs": [],
   "source": [
    "metadata_file = os.path.abspath(os.path.join(os.getcwd(), '..', 'data', 'raw', 'metadata', 'not-hist-feces-metadata.tsv'))\n",
    "experiment_folder = os.path.abspath(os.path.join(os.getcwd(), '..', 'experiments', 'thayane-feces-01'))\n",
    "img_folder = os.path.abspath(os.path.join(experiment_folder, 'imgs'))\n",
    "threads = 6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.329821Z",
     "start_time": "2022-06-02T14:34:05.300705Z"
    }
   },
   "outputs": [],
   "source": [
    "qiime_folder = os.path.join(experiment_folder, 'qiime-artifacts')\n",
    "table_file = os.path.join(qiime_folder, 'dada2-tabs.qza')\n",
    "taxon_file = os.path.join(qiime_folder, 'metatax.qza')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Custom functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.344016Z",
     "start_time": "2022-06-02T14:34:05.331857Z"
    }
   },
   "outputs": [],
   "source": [
    "def top_counts(df, col_idx):\n",
    "    species = []\n",
    "    counts = []\n",
    "    full_tax = []\n",
    "    cnt = 0\n",
    "    for i, v in df[col_idx].sort_values(ascending=False).iteritems():\n",
    "        sfield = i.split(';')[-1]\n",
    "        if sfield != '__':\n",
    "            cnt += 1\n",
    "            species.append(sfield[3:])\n",
    "            counts.append(int(v))\n",
    "            full_tax.append(i)\n",
    "        if cnt >= 10:\n",
    "            break\n",
    "    return species, counts, full_tax"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data ingestion"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ingesting the Metadata table\n",
    "\n",
    "We're ingesting the metadata `TSV` file as a `Metadata` object of QIIME2 API."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.378163Z",
     "start_time": "2022-06-02T14:34:05.345722Z"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Metadata\n",
       "--------\n",
       "66 IDs x 8 columns\n",
       "s_name:          ColumnProperties(type='categorical')\n",
       "observations:    ColumnProperties(type='categorical')\n",
       "individuo:       ColumnProperties(type='categorical')\n",
       "id_vaginal:      ColumnProperties(type='categorical')\n",
       "id_fezes:        ColumnProperties(type='categorical')\n",
       "local_de_coleta: ColumnProperties(type='categorical')\n",
       "idade:           ColumnProperties(type='numeric')\n",
       "class_meno:      ColumnProperties(type='categorical')\n",
       "\n",
       "Call to_dataframe() for a tabular representation."
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Ingest metadata tsv to qiime2.metadata.metadata.Metadata object\n",
    "sample_metadata = Metadata.load(metadata_file)\n",
    "\n",
    "# tabulate(sample_metadata).visualization\n",
    "sample_metadata"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We are creating a `DataFrame` object of the `Metadata` artifact."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.382511Z",
     "start_time": "2022-06-02T14:34:05.380243Z"
    }
   },
   "outputs": [],
   "source": [
    "samples_df = sample_metadata.to_dataframe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ingesting the complete ASV table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We're ingesting the ASV table with filtered features through the DADA2 algorithm. This artifact contains the absolute abundance of each ASV feature for all samples."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.405537Z",
     "start_time": "2022-06-02T14:34:05.383992Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<artifact: FeatureTable[Frequency] uuid: d5ba9a95-3a4d-4abb-80f8-899291b5be2d>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "frequency_table_path = table_file\n",
    "frequency_table = Artifact.load(frequency_table_path)\n",
    "frequency_table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Filtering samples "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.521006Z",
     "start_time": "2022-06-02T14:34:05.407074Z"
    }
   },
   "outputs": [],
   "source": [
    "# Create the SQL statement\n",
    "ids_to_filter_out = ('MV10', 'MV29', 'MV45', 'MV49', 'MV66', 'MV69', 'MV80', 'MV82', 'MV93', 'MV126', )\n",
    "sql = ', '.join([f\"'{x}'\" for x in ids_to_filter_out])\n",
    "sql = f'[id_vaginal] IN ({sql})'\n",
    "\n",
    "frequency_table = filter_samples(\n",
    "    table = frequency_table, \n",
    "    metadata = sample_metadata,\n",
    "    where = sql,\n",
    "    exclude_ids = True,\n",
    "    filter_empty_features = True,\n",
    "    min_frequency = 1,\n",
    "    min_features = 1,\n",
    ").filtered_table\n",
    "\n",
    "samples_df = samples_df[~samples_df['id_vaginal'].isin(ids_to_filter_out)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here, we're generating the visualization of the complete ASV table."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:05.525157Z",
     "start_time": "2022-06-02T14:34:05.522825Z"
    }
   },
   "outputs": [],
   "source": [
    "#metadata.visualizers.tabulate(frequency_table.view(Metadata)).visualization"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We're transforming the artifact `FeatureTable[Frequency]` to a Pandas `DataFrame` object to further processing using Python."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.832248Z",
     "start_time": "2022-06-02T14:34:05.528023Z"
    },
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>id</th>\n",
       "      <th>I1-M05</th>\n",
       "      <th>I10-M91</th>\n",
       "      <th>I11-M44</th>\n",
       "      <th>I12-M45</th>\n",
       "      <th>I13-M46</th>\n",
       "      <th>I14-M47</th>\n",
       "      <th>I15-M49</th>\n",
       "      <th>I16-M52</th>\n",
       "      <th>I17-M55</th>\n",
       "      <th>I18-M07</th>\n",
       "      <th>...</th>\n",
       "      <th>I68-M144</th>\n",
       "      <th>I69-M148</th>\n",
       "      <th>I7-M36</th>\n",
       "      <th>I70-M150</th>\n",
       "      <th>I71-M151</th>\n",
       "      <th>I72-M155</th>\n",
       "      <th>I73-M156</th>\n",
       "      <th>I75-M162</th>\n",
       "      <th>I76-M164</th>\n",
       "      <th>I8-M39</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>074b2d2eeb19288d75bf8e64784db602</th>\n",
       "      <td>0.0</td>\n",
       "      <td>786.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1118.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1259.0</td>\n",
       "      <td>741.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1263.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6c3b33991621b6c3e04992794a55a3d9</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1634.0</td>\n",
       "      <td>1228.0</td>\n",
       "      <td>1436.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1140.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1427.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>773.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8b7f2e8ca48676f3a47dfa784c8a9efe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>540.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>872.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3095.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>652.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7a1d4d3ec513655bbe964c4ab022e6fe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>444.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>574.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>568.0</td>\n",
       "      <td>726.0</td>\n",
       "      <td>1033.0</td>\n",
       "      <td>315.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>b53b25874d0529b37d36bfc78e32c894</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1464.0</td>\n",
       "      <td>1300.0</td>\n",
       "      <td>1210.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1318.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2022.0</td>\n",
       "      <td>621.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ee5a1924a299e186d7f904e5aa898bd1</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143582bcba9a90e4a585ed60042a6f0d</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>c713157aa6936b23861463951dfb6a3b</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>bd157fd42be3b6728d0080ee52836c14</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7be16af1fd4a487fd9e6380727a69555</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2918 rows × 66 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "id                                I1-M05  I10-M91  I11-M44  I12-M45  I13-M46  \\\n",
       "074b2d2eeb19288d75bf8e64784db602     0.0    786.0      0.0   1118.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9     0.0   1634.0   1228.0   1436.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe     0.0    540.0      0.0    872.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe     0.0      0.0    444.0      0.0     52.0   \n",
       "b53b25874d0529b37d36bfc78e32c894     0.0   1464.0   1300.0   1210.0      0.0   \n",
       "...                                  ...      ...      ...      ...      ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1     0.0      0.0      0.0      0.0      0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d     0.0      0.0      0.0      0.0      0.0   \n",
       "c713157aa6936b23861463951dfb6a3b     0.0      0.0      0.0      0.0      0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14     0.0      0.0      0.0      0.0      0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555     0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "id                                I14-M47  I15-M49  I16-M52  I17-M55  I18-M07  \\\n",
       "074b2d2eeb19288d75bf8e64784db602      0.0      0.0      0.0    330.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9      0.0      0.0      0.0      0.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe      0.0      0.0      0.0      0.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe    574.0      0.0      0.0      0.0      0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894      0.0      0.0      0.0      0.0      0.0   \n",
       "...                                   ...      ...      ...      ...      ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1      0.0      0.0      0.0      0.0      0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d      0.0      0.0      0.0      0.0      0.0   \n",
       "c713157aa6936b23861463951dfb6a3b      0.0      0.0      0.0      0.0      0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14      0.0      0.0      0.0      0.0      0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555      0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "id                                ...  I68-M144  I69-M148  I7-M36  I70-M150  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  ...       0.0       0.0     0.0       0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9  ...    1140.0       0.0     0.0       0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  ...       0.0       0.0  3095.0       0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  ...       0.0       0.0     0.0       0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894  ...       0.0       0.0     0.0       0.0   \n",
       "...                               ...       ...       ...     ...       ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1  ...       0.0       0.0     0.0       0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d  ...       0.0       0.0     0.0       0.0   \n",
       "c713157aa6936b23861463951dfb6a3b  ...       0.0       0.0     0.0       0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14  ...       0.0       0.0     0.0       0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555  ...       0.0       0.0     0.0       0.0   \n",
       "\n",
       "id                                I71-M151  I72-M155  I73-M156  I75-M162  \\\n",
       "074b2d2eeb19288d75bf8e64784db602       0.0    1259.0     741.0       0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9       0.0       0.0    1427.0       0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe       0.0       0.0       0.0       0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe       0.0     568.0     726.0    1033.0   \n",
       "b53b25874d0529b37d36bfc78e32c894       0.0       0.0    1318.0       0.0   \n",
       "...                                    ...       ...       ...       ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1       0.0       0.0       0.0       0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d       0.0       0.0       0.0       0.0   \n",
       "c713157aa6936b23861463951dfb6a3b       0.0       0.0       1.0       0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14       0.0       0.0       1.0       0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555       0.0       0.0       0.0       1.0   \n",
       "\n",
       "id                                I76-M164  I8-M39  \n",
       "074b2d2eeb19288d75bf8e64784db602       0.0  1263.0  \n",
       "6c3b33991621b6c3e04992794a55a3d9       0.0   773.0  \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe       0.0   652.0  \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe     315.0     0.0  \n",
       "b53b25874d0529b37d36bfc78e32c894    2022.0   621.0  \n",
       "...                                    ...     ...  \n",
       "ee5a1924a299e186d7f904e5aa898bd1       0.0     0.0  \n",
       "143582bcba9a90e4a585ed60042a6f0d       0.0     0.0  \n",
       "c713157aa6936b23861463951dfb6a3b       0.0     0.0  \n",
       "bd157fd42be3b6728d0080ee52836c14       0.0     0.0  \n",
       "7be16af1fd4a487fd9e6380727a69555       0.0     0.0  \n",
       "\n",
       "[2918 rows x 66 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table_df = frequency_table.view(Metadata).to_dataframe().T\n",
    "table_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ingesting the complete **Taxonomy** artifact\n",
    "\n",
    "We ingest the complete `FeatureData[Taxonomy]` artifact. This file contains all inferred taxonomies for each feature as the associated confidence score."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.866696Z",
     "start_time": "2022-06-02T14:34:06.833810Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<artifact: FeatureData[Taxonomy] uuid: 77490e83-8c5f-44d2-9360-5fcbe79fe7d5>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "taxon_path = taxon_file\n",
    "table_tax = Artifact.load(taxon_path)\n",
    "table_tax"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We are generating a visualization of the new Taxonomy table with all inferred taxonomies of all features."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.871510Z",
     "start_time": "2022-06-02T14:34:06.867991Z"
    }
   },
   "outputs": [],
   "source": [
    "# metadata.visualizers.tabulate(table_tax.view(Metadata)).visualization"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We're transforming the artifact `FeatureTable[Taxonomy]` to a Pandas `DataFrame` object to further processing using Python."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.910033Z",
     "start_time": "2022-06-02T14:34:06.873106Z"
    }
   },
   "outputs": [],
   "source": [
    "table_tax_df = table_tax.view(Metadata).to_dataframe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get samples IDs by menopause class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.915152Z",
     "start_time": "2022-06-02T14:34:06.911371Z"
    }
   },
   "outputs": [],
   "source": [
    "samples_by_class = {k: samples_df[samples_df['class_meno']==str(k)].index.to_list() \n",
    "     for k in range(0,3)}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transforming the taxonomy Dataframe by expanding taxonomic columns\n",
    "\n",
    "The Taxonomy column contains values as a string with all the inferred taxonomy levels. So, we transform these values by splitting the string and separating each taxonomy level into a new column.\n",
    "\n",
    "We are using the following taxonomic level names: `Reino`, `Filo`, `Classe`, `Ordem`, `Família`, `Gênero`, `Espécie`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.942945Z",
     "start_time": "2022-06-02T14:34:06.917498Z"
    }
   },
   "outputs": [],
   "source": [
    "tax_levels = ['Reino', 'Filo', 'Classe', 'Ordem', 'Família', 'Gênero', 'Espécie']\n",
    "tax_levels = ['Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', 'Species']\n",
    "table_tax_df[tax_levels] = table_tax_df['Taxon'].str.split(';', expand=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Analisys"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Taxononomy Table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Inferred taxonomy numbers\n",
    "\n",
    "We will count the numbers of inferred taxonomy for each taxonomic level.\n",
    "\n",
    "First, we generate a new Dataframe by merging the complete taxonomic table with features IDs of **swab vaginal** samples."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:06.984137Z",
     "start_time": "2022-06-02T14:34:06.944384Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>I1-M05</th>\n",
       "      <th>I10-M91</th>\n",
       "      <th>I11-M44</th>\n",
       "      <th>I12-M45</th>\n",
       "      <th>I13-M46</th>\n",
       "      <th>I14-M47</th>\n",
       "      <th>I15-M49</th>\n",
       "      <th>I16-M52</th>\n",
       "      <th>I17-M55</th>\n",
       "      <th>I18-M07</th>\n",
       "      <th>...</th>\n",
       "      <th>I8-M39</th>\n",
       "      <th>Taxon</th>\n",
       "      <th>Confidence</th>\n",
       "      <th>Kingdom</th>\n",
       "      <th>Phylum</th>\n",
       "      <th>Class</th>\n",
       "      <th>Order</th>\n",
       "      <th>Family</th>\n",
       "      <th>Genus</th>\n",
       "      <th>Species</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>074b2d2eeb19288d75bf8e64784db602</th>\n",
       "      <td>0.0</td>\n",
       "      <td>786.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1118.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1263.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9361387167487187</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6c3b33991621b6c3e04992794a55a3d9</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1634.0</td>\n",
       "      <td>1228.0</td>\n",
       "      <td>1436.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>773.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9069445037484893</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8b7f2e8ca48676f3a47dfa784c8a9efe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>540.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>872.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>652.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9999025048147963</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Oscillospirales</td>\n",
       "      <td>f__Ruminococcaceae</td>\n",
       "      <td>g__Faecalibacterium</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7a1d4d3ec513655bbe964c4ab022e6fe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>444.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>574.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...</td>\n",
       "      <td>0.7348376775850926</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Bacteroidota</td>\n",
       "      <td>c__Bacteroidia</td>\n",
       "      <td>o__Bacteroidales</td>\n",
       "      <td>f__Bacteroidaceae</td>\n",
       "      <td>g__Bacteroides</td>\n",
       "      <td>s__Bacteroides_vulgatus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>b53b25874d0529b37d36bfc78e32c894</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1464.0</td>\n",
       "      <td>1300.0</td>\n",
       "      <td>1210.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>621.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9210205535092991</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ee5a1924a299e186d7f904e5aa898bd1</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Negativicutes; ...</td>\n",
       "      <td>0.9990948331078099</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Negativicutes</td>\n",
       "      <td>o__Veillonellales-Selenomonadales</td>\n",
       "      <td>f__Veillonellaceae</td>\n",
       "      <td>g__Dialister</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143582bcba9a90e4a585ed60042a6f0d</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.8940617497317686</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Oscillospirales</td>\n",
       "      <td>f__Ruminococcaceae</td>\n",
       "      <td>g__Ruminococcus</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>c713157aa6936b23861463951dfb6a3b</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Bacilli; o__Ery...</td>\n",
       "      <td>0.9997641168791319</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Bacilli</td>\n",
       "      <td>o__Erysipelotrichales</td>\n",
       "      <td>f__Erysipelotrichaceae</td>\n",
       "      <td>g__Holdemanella</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>bd157fd42be3b6728d0080ee52836c14</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9995510110548353</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Lachnospiraceae_UCG-010</td>\n",
       "      <td>s__uncultured_organism</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7be16af1fd4a487fd9e6380727a69555</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Negativicutes; ...</td>\n",
       "      <td>0.8996226089242056</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Negativicutes</td>\n",
       "      <td>o__Veillonellales-Selenomonadales</td>\n",
       "      <td>f__Veillonellaceae</td>\n",
       "      <td>g__Allisonella</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2918 rows × 75 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  I1-M05  I10-M91  I11-M44  I12-M45  I13-M46  \\\n",
       "074b2d2eeb19288d75bf8e64784db602     0.0    786.0      0.0   1118.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9     0.0   1634.0   1228.0   1436.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe     0.0    540.0      0.0    872.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe     0.0      0.0    444.0      0.0     52.0   \n",
       "b53b25874d0529b37d36bfc78e32c894     0.0   1464.0   1300.0   1210.0      0.0   \n",
       "...                                  ...      ...      ...      ...      ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1     0.0      0.0      0.0      0.0      0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d     0.0      0.0      0.0      0.0      0.0   \n",
       "c713157aa6936b23861463951dfb6a3b     0.0      0.0      0.0      0.0      0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14     0.0      0.0      0.0      0.0      0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555     0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "                                  I14-M47  I15-M49  I16-M52  I17-M55  I18-M07  \\\n",
       "074b2d2eeb19288d75bf8e64784db602      0.0      0.0      0.0    330.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9      0.0      0.0      0.0      0.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe      0.0      0.0      0.0      0.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe    574.0      0.0      0.0      0.0      0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894      0.0      0.0      0.0      0.0      0.0   \n",
       "...                                   ...      ...      ...      ...      ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1      0.0      0.0      0.0      0.0      0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d      0.0      0.0      0.0      0.0      0.0   \n",
       "c713157aa6936b23861463951dfb6a3b      0.0      0.0      0.0      0.0      0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14      0.0      0.0      0.0      0.0      0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555      0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "                                  ...  I8-M39  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  ...  1263.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9  ...   773.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  ...   652.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  ...     0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894  ...   621.0   \n",
       "...                               ...     ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1  ...     0.0   \n",
       "143582bcba9a90e4a585ed60042a6f0d  ...     0.0   \n",
       "c713157aa6936b23861463951dfb6a3b  ...     0.0   \n",
       "bd157fd42be3b6728d0080ee52836c14  ...     0.0   \n",
       "7be16af1fd4a487fd9e6380727a69555  ...     0.0   \n",
       "\n",
       "                                                                              Taxon  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "6c3b33991621b6c3e04992794a55a3d9  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...   \n",
       "b53b25874d0529b37d36bfc78e32c894  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "...                                                                             ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1  d__Bacteria; p__Firmicutes; c__Negativicutes; ...   \n",
       "143582bcba9a90e4a585ed60042a6f0d  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "c713157aa6936b23861463951dfb6a3b  d__Bacteria; p__Firmicutes; c__Bacilli; o__Ery...   \n",
       "bd157fd42be3b6728d0080ee52836c14  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "7be16af1fd4a487fd9e6380727a69555  d__Bacteria; p__Firmicutes; c__Negativicutes; ...   \n",
       "\n",
       "                                          Confidence      Kingdom  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  0.9361387167487187  d__Bacteria   \n",
       "6c3b33991621b6c3e04992794a55a3d9  0.9069445037484893  d__Bacteria   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  0.9999025048147963  d__Bacteria   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  0.7348376775850926  d__Bacteria   \n",
       "b53b25874d0529b37d36bfc78e32c894  0.9210205535092991  d__Bacteria   \n",
       "...                                              ...          ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1  0.9990948331078099  d__Bacteria   \n",
       "143582bcba9a90e4a585ed60042a6f0d  0.8940617497317686  d__Bacteria   \n",
       "c713157aa6936b23861463951dfb6a3b  0.9997641168791319  d__Bacteria   \n",
       "bd157fd42be3b6728d0080ee52836c14  0.9995510110548353  d__Bacteria   \n",
       "7be16af1fd4a487fd9e6380727a69555  0.8996226089242056  d__Bacteria   \n",
       "\n",
       "                                            Phylum              Class  \\\n",
       "074b2d2eeb19288d75bf8e64784db602     p__Firmicutes      c__Clostridia   \n",
       "6c3b33991621b6c3e04992794a55a3d9     p__Firmicutes      c__Clostridia   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe     p__Firmicutes      c__Clostridia   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe   p__Bacteroidota     c__Bacteroidia   \n",
       "b53b25874d0529b37d36bfc78e32c894     p__Firmicutes      c__Clostridia   \n",
       "...                                            ...                ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1     p__Firmicutes   c__Negativicutes   \n",
       "143582bcba9a90e4a585ed60042a6f0d     p__Firmicutes      c__Clostridia   \n",
       "c713157aa6936b23861463951dfb6a3b     p__Firmicutes         c__Bacilli   \n",
       "bd157fd42be3b6728d0080ee52836c14     p__Firmicutes      c__Clostridia   \n",
       "7be16af1fd4a487fd9e6380727a69555     p__Firmicutes   c__Negativicutes   \n",
       "\n",
       "                                                               Order  \\\n",
       "074b2d2eeb19288d75bf8e64784db602                   o__Lachnospirales   \n",
       "6c3b33991621b6c3e04992794a55a3d9                   o__Lachnospirales   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe                  o__Oscillospirales   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe                    o__Bacteroidales   \n",
       "b53b25874d0529b37d36bfc78e32c894                   o__Lachnospirales   \n",
       "...                                                              ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1   o__Veillonellales-Selenomonadales   \n",
       "143582bcba9a90e4a585ed60042a6f0d                  o__Oscillospirales   \n",
       "c713157aa6936b23861463951dfb6a3b               o__Erysipelotrichales   \n",
       "bd157fd42be3b6728d0080ee52836c14                   o__Lachnospirales   \n",
       "7be16af1fd4a487fd9e6380727a69555   o__Veillonellales-Selenomonadales   \n",
       "\n",
       "                                                   Family  \\\n",
       "074b2d2eeb19288d75bf8e64784db602       f__Lachnospiraceae   \n",
       "6c3b33991621b6c3e04992794a55a3d9       f__Lachnospiraceae   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe       f__Ruminococcaceae   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe        f__Bacteroidaceae   \n",
       "b53b25874d0529b37d36bfc78e32c894       f__Lachnospiraceae   \n",
       "...                                                   ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1       f__Veillonellaceae   \n",
       "143582bcba9a90e4a585ed60042a6f0d       f__Ruminococcaceae   \n",
       "c713157aa6936b23861463951dfb6a3b   f__Erysipelotrichaceae   \n",
       "bd157fd42be3b6728d0080ee52836c14       f__Lachnospiraceae   \n",
       "7be16af1fd4a487fd9e6380727a69555       f__Veillonellaceae   \n",
       "\n",
       "                                                        Genus  \\\n",
       "074b2d2eeb19288d75bf8e64784db602              g__Agathobacter   \n",
       "6c3b33991621b6c3e04992794a55a3d9              g__Agathobacter   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe          g__Faecalibacterium   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe               g__Bacteroides   \n",
       "b53b25874d0529b37d36bfc78e32c894              g__Agathobacter   \n",
       "...                                                       ...   \n",
       "ee5a1924a299e186d7f904e5aa898bd1                 g__Dialister   \n",
       "143582bcba9a90e4a585ed60042a6f0d              g__Ruminococcus   \n",
       "c713157aa6936b23861463951dfb6a3b              g__Holdemanella   \n",
       "bd157fd42be3b6728d0080ee52836c14   g__Lachnospiraceae_UCG-010   \n",
       "7be16af1fd4a487fd9e6380727a69555               g__Allisonella   \n",
       "\n",
       "                                                   Species  \n",
       "074b2d2eeb19288d75bf8e64784db602                      None  \n",
       "6c3b33991621b6c3e04992794a55a3d9                      None  \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe                      None  \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe   s__Bacteroides_vulgatus  \n",
       "b53b25874d0529b37d36bfc78e32c894                      None  \n",
       "...                                                    ...  \n",
       "ee5a1924a299e186d7f904e5aa898bd1                      None  \n",
       "143582bcba9a90e4a585ed60042a6f0d                      None  \n",
       "c713157aa6936b23861463951dfb6a3b                      None  \n",
       "bd157fd42be3b6728d0080ee52836c14    s__uncultured_organism  \n",
       "7be16af1fd4a487fd9e6380727a69555                      None  \n",
       "\n",
       "[2918 rows x 75 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table_cnt_tax_df = pd.merge(table_df, table_tax_df, left_index=True, right_index=True)\n",
    "table_cnt_tax_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, we show the number of inferred taxons by taxonomic level."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:07.019417Z",
     "start_time": "2022-06-02T14:34:06.985924Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>I1-M05</th>\n",
       "      <th>I10-M91</th>\n",
       "      <th>I11-M44</th>\n",
       "      <th>I12-M45</th>\n",
       "      <th>I13-M46</th>\n",
       "      <th>I14-M47</th>\n",
       "      <th>I15-M49</th>\n",
       "      <th>I16-M52</th>\n",
       "      <th>I17-M55</th>\n",
       "      <th>I18-M07</th>\n",
       "      <th>...</th>\n",
       "      <th>I8-M39</th>\n",
       "      <th>Taxon</th>\n",
       "      <th>Confidence</th>\n",
       "      <th>Kingdom</th>\n",
       "      <th>Phylum</th>\n",
       "      <th>Class</th>\n",
       "      <th>Order</th>\n",
       "      <th>Family</th>\n",
       "      <th>Genus</th>\n",
       "      <th>Species</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>074b2d2eeb19288d75bf8e64784db602</th>\n",
       "      <td>0.0</td>\n",
       "      <td>786.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1118.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1263.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9361387167487187</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6c3b33991621b6c3e04992794a55a3d9</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1634.0</td>\n",
       "      <td>1228.0</td>\n",
       "      <td>1436.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>773.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9069445037484893</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8b7f2e8ca48676f3a47dfa784c8a9efe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>540.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>872.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>652.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9999025048147963</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Oscillospirales</td>\n",
       "      <td>f__Ruminococcaceae</td>\n",
       "      <td>g__Faecalibacterium</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7a1d4d3ec513655bbe964c4ab022e6fe</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>444.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>574.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...</td>\n",
       "      <td>0.7348376775850926</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Bacteroidota</td>\n",
       "      <td>c__Bacteroidia</td>\n",
       "      <td>o__Bacteroidales</td>\n",
       "      <td>f__Bacteroidaceae</td>\n",
       "      <td>g__Bacteroides</td>\n",
       "      <td>s__Bacteroides_vulgatus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>b53b25874d0529b37d36bfc78e32c894</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1464.0</td>\n",
       "      <td>1300.0</td>\n",
       "      <td>1210.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>621.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9210205535092991</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Lachnospirales</td>\n",
       "      <td>f__Lachnospiraceae</td>\n",
       "      <td>g__Agathobacter</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2768bae087d0fb10cbf8a486a444b931</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...</td>\n",
       "      <td>0.8105951408678893</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Bacteroidota</td>\n",
       "      <td>c__Bacteroidia</td>\n",
       "      <td>o__Bacteroidales</td>\n",
       "      <td>f__Prevotellaceae</td>\n",
       "      <td>g__Prevotella</td>\n",
       "      <td>s__uncultured_bacterium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f2ee0f6b708acf2284739b07bfb8a910</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9999342140386148</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Oscillospirales</td>\n",
       "      <td>f__Ruminococcaceae</td>\n",
       "      <td>g__Incertae_Sedis</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>440b18f112d726951157996929988d38</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Clostridia; o__...</td>\n",
       "      <td>0.9993214202378717</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Clostridia</td>\n",
       "      <td>o__Oscillospirales</td>\n",
       "      <td>f__Ruminococcaceae</td>\n",
       "      <td>g__Subdoligranulum</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fa52840a8948f2b92eb37f273c919b00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...</td>\n",
       "      <td>0.9998913455939266</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Bacteroidota</td>\n",
       "      <td>c__Bacteroidia</td>\n",
       "      <td>o__Bacteroidales</td>\n",
       "      <td>f__Bacteroidaceae</td>\n",
       "      <td>g__Bacteroides</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>890138d5a18e44b8337f1c60308d82a8</th>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>d__Bacteria; p__Firmicutes; c__Bacilli; o__Lac...</td>\n",
       "      <td>0.9999628992977111</td>\n",
       "      <td>d__Bacteria</td>\n",
       "      <td>p__Firmicutes</td>\n",
       "      <td>c__Bacilli</td>\n",
       "      <td>o__Lactobacillales</td>\n",
       "      <td>f__Streptococcaceae</td>\n",
       "      <td>g__Lactococcus</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>725 rows × 75 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  I1-M05  I10-M91  I11-M44  I12-M45  I13-M46  \\\n",
       "074b2d2eeb19288d75bf8e64784db602     0.0    786.0      0.0   1118.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9     0.0   1634.0   1228.0   1436.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe     0.0    540.0      0.0    872.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe     0.0      0.0    444.0      0.0     52.0   \n",
       "b53b25874d0529b37d36bfc78e32c894     0.0   1464.0   1300.0   1210.0      0.0   \n",
       "...                                  ...      ...      ...      ...      ...   \n",
       "2768bae087d0fb10cbf8a486a444b931     0.0      0.0      0.0      0.0      0.0   \n",
       "f2ee0f6b708acf2284739b07bfb8a910     0.0      1.0      0.0      0.0      0.0   \n",
       "440b18f112d726951157996929988d38     0.0      1.0      0.0      0.0      0.0   \n",
       "fa52840a8948f2b92eb37f273c919b00     0.0      1.0      0.0      0.0      0.0   \n",
       "890138d5a18e44b8337f1c60308d82a8     0.0      1.0      0.0      0.0      0.0   \n",
       "\n",
       "                                  I14-M47  I15-M49  I16-M52  I17-M55  I18-M07  \\\n",
       "074b2d2eeb19288d75bf8e64784db602      0.0      0.0      0.0    330.0      0.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9      0.0      0.0      0.0      0.0      0.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe      0.0      0.0      0.0      0.0      0.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe    574.0      0.0      0.0      0.0      0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894      0.0      0.0      0.0      0.0      0.0   \n",
       "...                                   ...      ...      ...      ...      ...   \n",
       "2768bae087d0fb10cbf8a486a444b931      0.0      0.0      0.0      0.0      0.0   \n",
       "f2ee0f6b708acf2284739b07bfb8a910      0.0      0.0      0.0      0.0      0.0   \n",
       "440b18f112d726951157996929988d38      0.0      0.0      0.0      0.0      0.0   \n",
       "fa52840a8948f2b92eb37f273c919b00      0.0      0.0      0.0      0.0      0.0   \n",
       "890138d5a18e44b8337f1c60308d82a8      0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "                                  ...  I8-M39  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  ...  1263.0   \n",
       "6c3b33991621b6c3e04992794a55a3d9  ...   773.0   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  ...   652.0   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  ...     0.0   \n",
       "b53b25874d0529b37d36bfc78e32c894  ...   621.0   \n",
       "...                               ...     ...   \n",
       "2768bae087d0fb10cbf8a486a444b931  ...     0.0   \n",
       "f2ee0f6b708acf2284739b07bfb8a910  ...     0.0   \n",
       "440b18f112d726951157996929988d38  ...     0.0   \n",
       "fa52840a8948f2b92eb37f273c919b00  ...     0.0   \n",
       "890138d5a18e44b8337f1c60308d82a8  ...     0.0   \n",
       "\n",
       "                                                                              Taxon  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "6c3b33991621b6c3e04992794a55a3d9  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...   \n",
       "b53b25874d0529b37d36bfc78e32c894  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "...                                                                             ...   \n",
       "2768bae087d0fb10cbf8a486a444b931  d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...   \n",
       "f2ee0f6b708acf2284739b07bfb8a910  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "440b18f112d726951157996929988d38  d__Bacteria; p__Firmicutes; c__Clostridia; o__...   \n",
       "fa52840a8948f2b92eb37f273c919b00  d__Bacteria; p__Bacteroidota; c__Bacteroidia; ...   \n",
       "890138d5a18e44b8337f1c60308d82a8  d__Bacteria; p__Firmicutes; c__Bacilli; o__Lac...   \n",
       "\n",
       "                                          Confidence      Kingdom  \\\n",
       "074b2d2eeb19288d75bf8e64784db602  0.9361387167487187  d__Bacteria   \n",
       "6c3b33991621b6c3e04992794a55a3d9  0.9069445037484893  d__Bacteria   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe  0.9999025048147963  d__Bacteria   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe  0.7348376775850926  d__Bacteria   \n",
       "b53b25874d0529b37d36bfc78e32c894  0.9210205535092991  d__Bacteria   \n",
       "...                                              ...          ...   \n",
       "2768bae087d0fb10cbf8a486a444b931  0.8105951408678893  d__Bacteria   \n",
       "f2ee0f6b708acf2284739b07bfb8a910  0.9999342140386148  d__Bacteria   \n",
       "440b18f112d726951157996929988d38  0.9993214202378717  d__Bacteria   \n",
       "fa52840a8948f2b92eb37f273c919b00  0.9998913455939266  d__Bacteria   \n",
       "890138d5a18e44b8337f1c60308d82a8  0.9999628992977111  d__Bacteria   \n",
       "\n",
       "                                            Phylum            Class  \\\n",
       "074b2d2eeb19288d75bf8e64784db602     p__Firmicutes    c__Clostridia   \n",
       "6c3b33991621b6c3e04992794a55a3d9     p__Firmicutes    c__Clostridia   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe     p__Firmicutes    c__Clostridia   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe   p__Bacteroidota   c__Bacteroidia   \n",
       "b53b25874d0529b37d36bfc78e32c894     p__Firmicutes    c__Clostridia   \n",
       "...                                            ...              ...   \n",
       "2768bae087d0fb10cbf8a486a444b931   p__Bacteroidota   c__Bacteroidia   \n",
       "f2ee0f6b708acf2284739b07bfb8a910     p__Firmicutes    c__Clostridia   \n",
       "440b18f112d726951157996929988d38     p__Firmicutes    c__Clostridia   \n",
       "fa52840a8948f2b92eb37f273c919b00   p__Bacteroidota   c__Bacteroidia   \n",
       "890138d5a18e44b8337f1c60308d82a8     p__Firmicutes       c__Bacilli   \n",
       "\n",
       "                                                Order                Family  \\\n",
       "074b2d2eeb19288d75bf8e64784db602    o__Lachnospirales    f__Lachnospiraceae   \n",
       "6c3b33991621b6c3e04992794a55a3d9    o__Lachnospirales    f__Lachnospiraceae   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe   o__Oscillospirales    f__Ruminococcaceae   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe     o__Bacteroidales     f__Bacteroidaceae   \n",
       "b53b25874d0529b37d36bfc78e32c894    o__Lachnospirales    f__Lachnospiraceae   \n",
       "...                                               ...                   ...   \n",
       "2768bae087d0fb10cbf8a486a444b931     o__Bacteroidales     f__Prevotellaceae   \n",
       "f2ee0f6b708acf2284739b07bfb8a910   o__Oscillospirales    f__Ruminococcaceae   \n",
       "440b18f112d726951157996929988d38   o__Oscillospirales    f__Ruminococcaceae   \n",
       "fa52840a8948f2b92eb37f273c919b00     o__Bacteroidales     f__Bacteroidaceae   \n",
       "890138d5a18e44b8337f1c60308d82a8   o__Lactobacillales   f__Streptococcaceae   \n",
       "\n",
       "                                                 Genus  \\\n",
       "074b2d2eeb19288d75bf8e64784db602       g__Agathobacter   \n",
       "6c3b33991621b6c3e04992794a55a3d9       g__Agathobacter   \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe   g__Faecalibacterium   \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe        g__Bacteroides   \n",
       "b53b25874d0529b37d36bfc78e32c894       g__Agathobacter   \n",
       "...                                                ...   \n",
       "2768bae087d0fb10cbf8a486a444b931         g__Prevotella   \n",
       "f2ee0f6b708acf2284739b07bfb8a910     g__Incertae_Sedis   \n",
       "440b18f112d726951157996929988d38    g__Subdoligranulum   \n",
       "fa52840a8948f2b92eb37f273c919b00        g__Bacteroides   \n",
       "890138d5a18e44b8337f1c60308d82a8        g__Lactococcus   \n",
       "\n",
       "                                                   Species  \n",
       "074b2d2eeb19288d75bf8e64784db602                      None  \n",
       "6c3b33991621b6c3e04992794a55a3d9                      None  \n",
       "8b7f2e8ca48676f3a47dfa784c8a9efe                      None  \n",
       "7a1d4d3ec513655bbe964c4ab022e6fe   s__Bacteroides_vulgatus  \n",
       "b53b25874d0529b37d36bfc78e32c894                      None  \n",
       "...                                                    ...  \n",
       "2768bae087d0fb10cbf8a486a444b931   s__uncultured_bacterium  \n",
       "f2ee0f6b708acf2284739b07bfb8a910                      None  \n",
       "440b18f112d726951157996929988d38                      None  \n",
       "fa52840a8948f2b92eb37f273c919b00                      None  \n",
       "890138d5a18e44b8337f1c60308d82a8                      None  \n",
       "\n",
       "[725 rows x 75 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp = table_cnt_tax_df[samples_by_class[0]].sum(axis=1)\n",
    "table_cnt_tax_df[tmp!=0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:07.033418Z",
     "start_time": "2022-06-02T14:34:07.021340Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Kingdom</th>\n",
       "      <th>Phylum</th>\n",
       "      <th>Class</th>\n",
       "      <th>Order</th>\n",
       "      <th>Family</th>\n",
       "      <th>Genus</th>\n",
       "      <th>Species</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>#Taxons</th>\n",
       "      <td>3</td>\n",
       "      <td>10</td>\n",
       "      <td>14</td>\n",
       "      <td>30</td>\n",
       "      <td>53</td>\n",
       "      <td>137</td>\n",
       "      <td>96</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Kingdom  Phylum  Class  Order  Family  Genus  Species\n",
       "#Taxons        3      10     14     30      53    137       96"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unique_taxons = {l: list(filter(None, table_cnt_tax_df[l].unique())) for l in tax_levels}\n",
    "unique_taxons_counts_df = pd.DataFrame({x: [len(y)] for x, y in unique_taxons.items()}, index=['#Taxons'])\n",
    "unique_taxons_counts_df\n",
    "# print('--- Taxonomies found in the fezes ASV table ---')\n",
    "# for k, v in unique_taxons.items():\n",
    "#     print(f'{k}: {len(v)}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2022-06-02T14:34:07.303385Z",
     "start_time": "2022-06-02T14:34:07.034986Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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uLi4pstgjNViCi8JMWPGjDJ30n3x4kW1/3CVMcZY7aOwQd26dQv169cXnn/88ceIj49XaVGMMcaYwgZVUlKCFy9eCM+fP38OuVyu0qIYY4wxhcegRo8ejaFDh6Jv374AgCNHjmD8+PEqL4wxxljtprBB2dvbo3379oiIiAARYdWqVWjVqlV11MYYY6wWe2eDysnJga6uLp4/fw59fX3Y2NgI454/fy7cH4oxxhhThXc2qGnTpsHf3x+Ojo4QiUQgojL/P3nyZHXWyRhjrJZ5Z4Py9/cHAJw6darainlVeno65s2bh7t376KkpATff/89pk+frvDWF87Ozpg+fTq++eabaqqUMcaYKpTr1rg3b97EyZMncezYMeE/VSIiuLi4wMrKCseOHcPRo0eRl5eHP//8s8x0yvghKZ+RyBhj6knhSRLu7u64desWWrduXeZW73369FFZUREREdDW1oaTkxMAQENDAx4eHujVqxeaN2+OyMhIyGQy5OXlISAgAO7u7rhz5w5atmyJgoICIefcuXPw9fWFTCZDixYt4O3tjXr16sHS0hKOjo74559/8NNPP2HAgAEqWxbGGGOVo7BBxcTE4PDhw9VRi+D27dswNDQsM0xXVxcGBgaQy+W4evUqDhw4gAYNGmDDhg2oU6cOQkNDcfPmTTg6OgIAMjMz4efnhw0bNkBHRwcBAQHYsGEDXFxcAADa2trYsWNHtS4XY4yx8lPYoDp27Ig7d+5U66nlpSdivGu4mZmZcBbhpUuX4OzsDABo27atcKv0mJgY3LlzB8OGDQMAFBUVoWPHjkKWtbW1aheCMcZYlShsUA4ODhgyZAj09fXLnKAQGhqqsqJat279xnGunJwcpKenQywWo27dumXGvauZmZmZwcfH563zeD2DMcaYelF4koSHhweWLFmCdevWYe3atcJ/qtS9e3fk5+cjODgYwMsTGRYtWgQHB4c3GkuXLl2EZpmQkIBbt24BeLnld+XKFdy/fx8AkJ+fj8TERJXWzRhjTHkUNigDAwP06tULLVq0QLNmzYT/VEkkEmH16tU4cuQI+vTpg759+0JbWxuurq5vTDts2DDk5eXB1tYW69atg5GREQBAT08P3t7ecHV1ha2tLQYPHox79+6ptG7GGGPKo3AX31dffYVp06bBwsKizC4+VZ7FB7xsjG/bUnN0dBROhACAOnXq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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df = pd.DataFrame({'levels': tax_levels,\n",
    "                  'counts': [len(x) for x in unique_taxons.values()]})\n",
    "sns.set_style(\"whitegrid\")\n",
    "dbplot =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      